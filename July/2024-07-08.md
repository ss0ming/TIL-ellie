# TIL
## ë‚ ì§œ: 2024-07-08

### ìŠ¤í¬ëŸ¼
* ì»¤ë®¤ë‹ˆí‹° (ìŠ¤í”„ë§ë¶€íŠ¸)
  * í…ŒìŠ¤íŠ¸ ì§„í–‰

### í•™ìŠµ ë‚´ìš©
í”„ë¡ íŠ¸ì™€ ì—°ê²°í•˜ë ¤ê³  í–ˆëŠ”ë° êµ¬í˜„í•˜ì§€ ì•Šì€ ê¸°ëŠ¥ì´ ìˆì–´ êµ¬í˜„í–ˆë‹¤. íšŒì› ê´€ë¦¬ ê¸°ëŠ¥(ì´ë©”ì¼ê³¼ ë‹‰ë„¤ì„ ì¤‘ë³µ ì²´í¬, ì´ë©”ì¼ê³¼ ë‹‰ë„¤ì„ ìˆ˜ì •)ì„ ì¶”ê°€ ë° ìˆ˜ì •í–ˆë‹¤. ì´ë©”ì¼ê³¼ ë‹‰ë„¤ì„ ì¤‘ë³µ ì²´í¬ë¥¼ UserLoginControllerì— ë„£ì—ˆëŠ”ë° ì´ë©”ì¼ê³¼ ë‹‰ë„¤ì„ ìˆ˜ì •ì„ ì¶”ê°€í•˜ë©´ì„œ ìœ„ ê¸°ëŠ¥ë“¤ì„ UserManageControllerë¡œ ë„£ì–´ì¤¬ë‹¤.

```
package com.example.happy_community_back.domain.auth.controller;

import com.example.happy_community_back.domain.auth.dto.request.UserReqDto.UserModifyPasswordReqDto;
import com.example.happy_community_back.domain.auth.dto.request.UserReqDto.UserModifyNicknameReqDto;
import com.example.happy_community_back.domain.auth.dto.response.UserResDto;
import com.example.happy_community_back.domain.auth.service.UserManageService;
import com.example.happy_community_back.global.common.ApiResponseEntity;
import com.example.happy_community_back.global.common.ResponseText;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/user")
@RequiredArgsConstructor
public class UserManageController {

    private final UserManageService userManageService;

    /**
     * íšŒì› ì •ë³´ ì¡°íšŒ API
     */
    @PostMapping()
    public ResponseEntity<UserResDto> getInfo(@AuthenticationPrincipal UserDetails userDetails) {
        return ResponseEntity.ok(userManageService.getUserInfo(userDetails.getUsername()));
    }

    /**
     * ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ API
     */
    @PostMapping("/check-duplicate-email")
    public ResponseEntity<ApiResponseEntity<String>> checkDuplicateEmail(@RequestBody String email) {
        System.out.println(email);
        boolean isDuplicate = userManageService.checkDuplicateEmail(email);
        System.out.println(isDuplicate);

        return ResponseEntity.ok(ApiResponseEntity.of(isDuplicate ? ResponseText.DUPLICATE : ResponseText.OK));
    }

    /**
     * ë‹‰ë„¤ì„ ì¤‘ë³µ ì²´í¬ API
     */
    @PostMapping("/check-duplicate-nickname")
    public ResponseEntity<ApiResponseEntity<String>> checkDuplicateNickname(@RequestBody String nickname) {
        System.out.println(nickname);
        boolean isDuplicate = userManageService.checkDuplicateNickname(nickname);
        System.out.println(isDuplicate);
        return ResponseEntity.ok(ApiResponseEntity.of(isDuplicate ? ResponseText.DUPLICATE : ResponseText.OK));
    }

    /**
     * ë¹„ë°€ë²ˆí˜¸ ìˆ˜ì • API
     */
    @PutMapping("/password")
    public ResponseEntity<ApiResponseEntity<String>> modifyPassword(@Valid @RequestBody UserModifyPasswordReqDto userModifyPasswordReqDto, @AuthenticationPrincipal UserDetails userDetails) {
        userManageService.modifyPassword(userModifyPasswordReqDto, userDetails.getUsername());
        return ResponseEntity.ok(ApiResponseEntity.of(ResponseText.SUCCESS_MODIFY_PASSWORD));
    }

    /**
     * ë‹‰ë„¤ì„ ìˆ˜ì • API
     */
    @PutMapping("/nickname")
    public ResponseEntity<ApiResponseEntity<String>> modifyNickname(@Valid @RequestBody UserModifyNicknameReqDto userModifyNicknameReqDto, @AuthenticationPrincipal UserDetails userDetails) {
        userManageService.modifyNickname(userModifyNicknameReqDto, userDetails.getUsername());
        return ResponseEntity.ok(ApiResponseEntity.of(ResponseText.SUCCESS_MODIFY_NICKNAME));
    }

}
```

ì˜¤ë¥˜ê°€ í•˜ë‚˜ ë°œìƒí–ˆëŠ”ë° ì´ë©”ì¼ê³¼ ë‹‰ë„¤ì„ ì¤‘ë³µ ì²´í¬ ì‹œ ëª¨ë‘ "Ok"ë¥¼ ë³´ë‚´ëŠ” ìƒí™©ì´ ì¼ì–´ë‚¬ë‹¤. ì•„ì§ ì›ì¸ì„ ì°¾ì§€ ëª»í•´ ë‚´ì¼ ìˆ˜ì •í•  ì˜ˆì •ì´ë‹¤.

### ì˜¤ëŠ˜ì˜ íšŒê³ 
ë‚˜ë¦„ postmanìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ë©° ì˜ êµ¬í˜„í–ˆë‹¤ê³  ìƒê°í–ˆëŠ”ë° ë§‰ìƒ í”„ë¡ íŠ¸ì™€ ì—°ê²°í•˜ë ¤ë‹ˆê¹Œ ìˆ˜ì •í•´ì•¼í•  ë¶€ë¶„ì´ ë§ì•˜ë‹¤. ë‹¤ë¥¸ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ë•Œì—ëŠ” ì´ëŸ¬í•œ ë¶€ë¶„ë“¤ì— ëŒ€í•œ ê³ ë ¤í•´ë³´ë©° ì§„í–‰í•´ì•¼í•  ê²ƒ ê°™ë‹¤.

### ì°¸ê³ ìë£Œ ë° ë§í¬
[ğŸ”—](https://github.com/ss0ming/happy_community_back) ìŠ¤í”„ë§ë¶€íŠ¸ - ì»¤ë®¤ë‹ˆí‹°